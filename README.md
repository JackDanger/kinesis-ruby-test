# Testing Kinesis in pure Ruby

This is a small application that creates a Kinesis stream and times how long it takes to publish and then read all of the records in that stream.

It depends on the (autogenerated) public AWS Kinesis client library and nothing else.

## Usage

Set your AWS credentials either in your environment or in some other way that the AWS Ruby gem knows to pick it up and run the following:

    bundle
    bundle exec ruby app.rb


You should see something like the following:

    Creating kinesis stream "kinesis-test-rb"
    Retrieving shard id from new stream
    ...............
    starting to publish 4998 records in 17 threads
    published 4998 records in 34.97 seconds
    starting consumption of 4998 records
    consumed 4998 records in 1.97 seconds

This is from my laptop on my home network connection in SF. With 17 threads this script published about 142 QPS.

It appears a single thread can publish at best 16 QPS (when not starved for IO and scheduling). But even at 73 concurrent threads each one managed 4QPS. That seems like a reasonable range for calculating possible throughput per process per shard.
